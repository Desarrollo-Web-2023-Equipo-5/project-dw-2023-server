"use strict";(self.webpackChunkproject_dw_2023_client=self.webpackChunkproject_dw_2023_client||[]).push([[719],{4719:(Qt,A,c)=>{c.r(A),c.d(A,{ProtectedModule:()=>Mt});var u=c(4755),d=c(4660),R=c(5577),p=c(5580),t=c(2223),y=c(2340),f=c(4004),F=c(3144);let w=(()=>{class i{constructor(e){this.http=e,this.baseUrl=y.N.apiUrl||"http://localhost:3000/api"}updateImage(e,n,a){const s=new FormData;return s.append("file",e),this.http.put(`${this.baseUrl}/uploads/${n}/${a}`,s).pipe((0,f.U)(m=>m.img))}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(F.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var v=c(2018),g=c(1728),L=c(7081);function O(i,o){1&i&&t._UZ(0,"mat-progress-bar",7)}let N=(()=>{class i{constructor(e,n,a,s){this.dialogRef=e,this.data=n,this.fileUploadService=a,this.toastr=s,this.isUploading=!1}changeImage(e){this.uploadImg=e.target.files[0]}uploadImage(){this.isUploading=!0;const{collection:e,id:n}=this.data;this.fileUploadService.updateImage(this.uploadImg,e,n).subscribe({next:a=>{this.dialogRef.close(a),this.toastr.success("Image changed successfully")},error:a=>{this.toastr.error(a.error.errors[0].msg),this.isUploading=!1}})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(p.so),t.Y36(p.WI),t.Y36(w),t.Y36(v._W))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-upload-file-dialog"]],decls:10,vars:5,consts:[["mat-dialog-title",""],["mat-dialog-content","",1,"d-flex","flex-column","justify-content-center","aling-items-center","gap-3"],["type","file","id","formFile",1,"form-control",3,"disabled","change"],["color","accent","mat-flat-button","",3,"disabled","click"],["mode","indeterminate",4,"ngIf"],["mat-dialog-actions",""],["mat-button","","mat-dialog-close","","cdkFocusInitial","",3,"mat-dialog-close"],["mode","indeterminate"]],template:function(e,n){1&e&&(t.TgZ(0,"h1",0),t._uU(1,"Upload New Image"),t.qZA(),t.TgZ(2,"div",1)(3,"input",2),t.NdJ("change",function(s){return n.changeImage(s)}),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){return n.uploadImage()}),t._uU(5),t.qZA(),t.YNc(6,O,1,0,"mat-progress-bar",4),t.qZA(),t.TgZ(7,"div",5)(8,"button",6),t._uU(9," Close "),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("disabled",n.isUploading),t.xp6(1),t.Q6J("disabled",!n.uploadImg||n.isUploading),t.xp6(1),t.hij(" ",n.isUploading?"Uploading...":"Update Image"," "),t.xp6(1),t.Q6J("ngIf",n.isUploading),t.xp6(2),t.Q6J("mat-dialog-close",!1))},dependencies:[u.O5,g.lW,p.ZT,p.uh,p.xY,p.H8,L.pW]}),i})(),h=(()=>{class i{constructor(e){this.http=e,this.baseUrl=y.N.apiUrl||"http://localhost:3000/api"}getUserById(e){return this.http.get(`${this.baseUrl}/users/${e}`).pipe((0,f.U)(n=>n.user))}updateUser(e,n){return this.http.put(`${this.baseUrl}/users/${e}`,n)}getCurrentUserCampaigns(e){return this.http.get(`${this.baseUrl}/users/${e}/campaigns`).pipe((0,f.U)(n=>n.campaigns))}getLookingForGroupUsers(){return this.http.get(`${this.baseUrl}/users?lfg=true`)}createComment(e){return this.http.post(`${this.baseUrl}/comments`,e).pipe((0,f.U)(n=>n.id))}getComments(e){return this.http.get(`${this.baseUrl}/comments${e}`).pipe((0,f.U)(n=>n.comments))}deleteComment(e){return this.http.delete(`${this.baseUrl}/comments/${e}`)}createCampaign(e){return this.http.post(`${this.baseUrl}/campaigns`,e).pipe((0,f.U)(n=>n.id))}getCampaigns(){return this.http.get(`${this.baseUrl}/campaigns`).pipe((0,f.U)(e=>e.campaigns))}getCampaign(e){return this.http.get(`${this.baseUrl}/campaigns/${e}`).pipe((0,f.U)(n=>n.campaign))}updateCampaign(e,n){return this.http.put(`${this.baseUrl}/campaigns/${e}`,n)}getCharactersheetByUserId(e){return this.http.get(`${this.baseUrl}/users/${e}/characters`).pipe((0,f.U)(n=>n.characters[0]))}updateCharactersheet(e,n){return this.http.put(`${this.baseUrl}/characters/${e}`,n)}sendRequest(e){return this.http.post(`${this.baseUrl}/requests`,e)}getRequests(e){return this.http.get(`${this.baseUrl}/requests/for-creator/${e}`).pipe((0,f.U)(n=>n.requests))}updateRequest(e,n){return this.http.put(`${this.baseUrl}/requests/${e}`,n)}getInvites(e){return this.http.get(`${this.baseUrl}/requests/for-user/${e}`).pipe((0,f.U)(n=>n.requests))}}return i.\u0275fac=function(e){return new(e||i)(t.LFG(F.eN))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var b=c(9114),I=c(787),P=c(1217),r=c(9401);function M(i,o){if(1&i&&(t.TgZ(0,"mat-option",8),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.Q6J("value",e._id),t.xp6(1),t.Oqu(e.title)}}let Q=(()=>{class i{constructor(e,n,a){this.dialogRef=e,this.apiService=n,this.data=a,this.campaignOptions=[],this.selectedCampaign=""}ngOnInit(){this.apiService.getCurrentUserCampaigns(this.data.userId).subscribe({next:e=>{this.campaignOptions=e}})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(p.so),t.Y36(h),t.Y36(p.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-campaign-selector-dialog"]],decls:18,vars:8,consts:[["mat-dialog-title",""],["mat-dialog-content",""],[1,"d-flex","flex-column","justify-content-center"],[3,"ngModel","disabled","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["mat-dialog-actions",""],["mat-button","","mat-dialog-close","",3,"mat-dialog-close"],["mat-button","","mat-dialog-close","","cdkFocusInitial","",3,"disabled","mat-dialog-close"],[3,"value"]],template:function(e,n){1&e&&(t.TgZ(0,"h1",0),t._uU(1,"Invite to game"),t.qZA(),t.TgZ(2,"div",1)(3,"p"),t._uU(4," Do you want to invite "),t.TgZ(5,"b"),t._uU(6),t.qZA(),t._uU(7," to play? "),t.qZA(),t.TgZ(8,"mat-form-field",2)(9,"mat-label"),t._uU(10),t.qZA(),t.TgZ(11,"mat-select",3),t.NdJ("ngModelChange",function(s){return n.selectedCampaign=s}),t.YNc(12,M,2,2,"mat-option",4),t.qZA()()(),t.TgZ(13,"div",5)(14,"button",6),t._uU(15,"No"),t.qZA(),t.TgZ(16,"button",7),t._uU(17," Yes "),t.qZA()()),2&e&&(t.xp6(6),t.Oqu(n.data.toInviteName),t.xp6(4),t.Oqu(n.campaignOptions.length<=0?"No campaings to select":"Select Campaign"),t.xp6(1),t.Q6J("ngModel",n.selectedCampaign)("disabled",n.campaignOptions.length<=0),t.xp6(1),t.Q6J("ngForOf",n.campaignOptions),t.xp6(2),t.Q6J("mat-dialog-close",!1),t.xp6(2),t.Q6J("disabled",!n.selectedCampaign)("mat-dialog-close",n.selectedCampaign))},dependencies:[u.sg,g.lW,b.KE,b.hX,I.gD,P.ey,p.ZT,p.uh,p.xY,p.H8,r.JJ,r.On]}),i})();var _=c(7556),C=c(3617),l=c(6012),Z=c(3851),x=c(430),U=c(8097),G=c(8467);let k=(()=>{class i{constructor(e,n){this.dialogRef=e,this.data=n}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(p.so),t.Y36(p.WI))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-confirm-dialog"]],decls:9,vars:4,consts:[["mat-dialog-title",""],["mat-dialog-content",""],["mat-dialog-actions",""],["mat-button","","mat-dialog-close","",3,"mat-dialog-close"],["mat-button","","mat-dialog-close","","cdkFocusInitial","",3,"mat-dialog-close"]],template:function(e,n){1&e&&(t.TgZ(0,"h1",0),t._uU(1),t.qZA(),t.TgZ(2,"div",1),t._uU(3),t.qZA(),t.TgZ(4,"div",2)(5,"button",3),t._uU(6,"No"),t.qZA(),t.TgZ(7,"button",4),t._uU(8," Yes "),t.qZA()()),2&e&&(t.xp6(1),t.Oqu(n.data.title),t.xp6(2),t.Oqu(n.data.message),t.xp6(2),t.Q6J("mat-dialog-close",!1),t.xp6(2),t.Q6J("mat-dialog-close",!0))},dependencies:[g.lW,p.ZT,p.uh,p.xY,p.H8]}),i})();function $(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",5)(1,"button",6),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.updateComment())}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()(),t.TgZ(4,"button",7),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.deleteComment())}),t.TgZ(5,"mat-icon"),t._uU(6,"delete"),t.qZA()()()}}let j=(()=>{class i{get activeUser(){return this.authService.activeUser}constructor(e,n,a,s){this.authService=e,this.apiService=n,this.toastr=a,this.dialog=s,this.editMode=!1,this.deleteCommentEvent=new t.vpe}deleteComment(){this.dialog.open(k,{width:"250px",data:{title:"Delete Comment",message:"Are you sure you want to delete this comment?"}}).afterClosed().subscribe({next:n=>{n&&this.comment.id&&this.apiService.deleteComment(this.comment.id).subscribe({next:()=>{this.deleteCommentEvent.emit(this.comment),this.toastr.success("Comment deleted successfully")},error:()=>{this.toastr.error("Error deleting comment")}})}})}updateComment(){this.editMode=!0}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(_.e),t.Y36(h),t.Y36(v._W),t.Y36(p.uw))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-comment"]],inputs:{comment:"comment"},outputs:{deleteCommentEvent:"deleteCommentEvent"},decls:9,vars:5,consts:[[1,"comment","gap-2","p-2","d-flex","justify-content-between","border"],[1,"d-flex","flex-column","justify-content-center","align-items-center",3,"routerLink"],["mat-card-avatar","","alt","",3,"src"],[1,"text-center"],["class","gap-2 d-flex flex-column justify-content-center align-items-center",4,"ngIf"],[1,"gap-2","d-flex","flex-column","justify-content-center","align-items-center"],["disabled","","mat-mini-fab","","color","primary","aria-label","Example icon button with a menu icon",3,"click"],["mat-mini-fab","","color","warn","aria-label","Example icon button with a menu icon",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"div",1),t._UZ(2,"img",2),t.TgZ(3,"p",3),t._uU(4),t.qZA()(),t.TgZ(5,"div")(6,"p"),t._uU(7),t.qZA()(),t.YNc(8,$,7,0,"div",4),t.qZA()),2&e&&(t.xp6(1),t.MGl("routerLink","/dashboard/profile/",n.comment.creator.id,""),t.xp6(1),t.Q6J("src",n.comment.creator.img,t.LSH),t.xp6(2),t.Oqu(n.comment.creator.username),t.xp6(3),t.hij(" ",n.comment.content," "),t.xp6(1),t.Q6J("ngIf",n.comment.creator.id===(null==n.activeUser?null:n.activeUser.id)))},dependencies:[u.O5,d.rH,g.nh,x.Hw,l.kc],styles:[".comment[_ngcontent-%COMP%]{width:20em}"]}),i})();function E(i,o){1&i&&(t.TgZ(0,"button",9)(1,"mat-icon"),t._uU(2,"send"),t.qZA()())}function D(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"app-comment",12),t.NdJ("deleteCommentEvent",function(a){t.CHM(e);const s=t.oxw(3);return t.KtG(s.deleteComment(a))}),t.qZA()()}if(2&i){const e=o.$implicit;t.xp6(1),t.Q6J("comment",e)}}function H(i,o){if(1&i&&(t.TgZ(0,"div",10),t.YNc(1,D,2,1,"div",11),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",e.comments)}}function X(i,o){1&i&&(t.TgZ(0,"p",13),t._uU(1,"No comments to display"),t.qZA())}function B(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",2)(1,"form",3),t.NdJ("ngSubmit",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.sendComment())}),t.TgZ(2,"mat-form-field",4)(3,"mat-label"),t._uU(4,"Leave a comment"),t.qZA(),t._UZ(5,"textarea",5),t.YNc(6,E,3,0,"button",6),t.qZA()(),t.YNc(7,H,2,1,"div",7),t.YNc(8,X,2,0,"ng-template",null,8,t.W1O),t.qZA()}if(2&i){const e=t.MAs(9),n=t.oxw();let a;t.xp6(1),t.Q6J("formGroup",n.commentForm),t.xp6(5),t.Q6J("ngIf",null==(a=n.commentForm.get("comment"))?null:a.value),t.xp6(1),t.Q6J("ngIf",n.comments.length)("ngIfElse",e)}}function K(i,o){1&i&&(t.TgZ(0,"div",14),t._UZ(1,"mat-spinner"),t.qZA())}let J=(()=>{class i{get activeUser(){return this.authService.activeUser}constructor(e,n,a,s){this.fb=e,this.authService=n,this.apiService=a,this.toastr=s,this.userRef=null,this.postRef=null,this.comments=[],this.isLoadingComments=!1,this.commentForm=this.fb.group({comment:[""]})}ngOnInit(){this.isLoadingComments=!0,this.apiService.getComments(this.postRef?`?postRef=${this.postRef}`:`?userRef=${this.userRef}`).subscribe({next:n=>{this.comments=n,this.isLoadingComments=!1},error:n=>{this.toastr.error(n.error.errors[0].msg),this.isLoadingComments=!1}})}ngOnChanges(){this.isLoadingComments=!0,this.apiService.getComments(this.postRef?`?postRef=${this.postRef}`:`?userRef=${this.userRef}`).subscribe({next:n=>{this.comments=n,this.isLoadingComments=!1},error:n=>{this.toastr.error(n.error.errors[0].msg),this.isLoadingComments=!1}})}sendComment(){if(!this.commentForm.value.comment)return;const e={userRef:this.userRef,postRef:this.postRef,creator:this.authService.activeUser,content:this.commentForm.value.comment};this.apiService.createComment(e).subscribe({next:n=>{e.id=n,this.comments.push(e),this.commentForm.reset()},error:n=>{console.error(n),this.toastr.error(n.error.errors[0].msg)}})}deleteComment(e){const n=this.comments.findIndex(a=>a.id===e.id);-1!==n&&this.comments.splice(n,1)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(r.qu),t.Y36(_.e),t.Y36(h),t.Y36(v._W))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-comments-section"]],inputs:{userRef:"userRef",postRef:"postRef"},features:[t.TTD],decls:3,vars:2,consts:[["class","d-flex justify-content-around align-items-center flex-column",4,"ngIf","ngIfElse"],["loadingComments",""],[1,"d-flex","justify-content-around","align-items-center","flex-column"],["action","",3,"formGroup","ngSubmit"],[1,"m-3"],["formControlName","comment","matInput","","placeholder","Ex. Wow! Such Cool!..."],["matSuffix","","mat-icon-button","","aria-label","Send",4,"ngIf"],["class","d-flex flex-column gap-2",4,"ngIf","ngIfElse"],["noComments",""],["matSuffix","","mat-icon-button","","aria-label","Send"],[1,"d-flex","flex-column","gap-2"],[4,"ngFor","ngForOf"],[3,"comment","deleteCommentEvent"],[1,"text-center"],[1,"p-5","d-flex","justify-content-center","align-items-center","flex-column"]],template:function(e,n){if(1&e&&(t.YNc(0,B,10,4,"div",0),t.YNc(1,K,2,0,"ng-template",null,1,t.W1O)),2&e){const a=t.MAs(2);t.Q6J("ngIf",!n.isLoadingComments)("ngIfElse",a)}},dependencies:[u.sg,u.O5,g.RK,x.Hw,b.KE,b.hX,b.R9,U.Nt,G.Ou,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u,j]}),i})();function W(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",7),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.inviteToCampaign())}),t._uU(1," INVITE TO GAME "),t.qZA()}}function z(i,o){if(1&i&&(t.TgZ(0,"mat-card-actions"),t.YNc(1,W,2,0,"button",6),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",e.user.isLookingForGroup)}}function V(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",10),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.toogleLookingForGroup())}),t._uU(1," LOOK FOR A GROUP "),t.qZA()}if(2&i){const e=t.oxw(3);t.Q6J("disabled",e.isLoadingLookingForGroup)}}function tt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.toogleLookingForGroup())}),t._uU(1," STOP LOOKING FOR GROUP "),t.qZA()}if(2&i){const e=t.oxw(3);t.Q6J("disabled",e.isLoadingLookingForGroup)}}function et(i,o){if(1&i&&(t.TgZ(0,"mat-card-actions"),t.YNc(1,V,2,1,"button",8),t.YNc(2,tt,2,1,"button",9),t.qZA()),2&i){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!e.user.isLookingForGroup),t.xp6(1),t.Q6J("ngIf",e.user.isLookingForGroup)}}function it(i,o){if(1&i&&t._UZ(0,"app-comments-section",12),2&i){const e=t.oxw(2);t.Q6J("userRef",e.user.id)}}function nt(i,o){if(1&i&&(t.TgZ(0,"mat-list",14)(1,"mat-list-item",15)(2,"span",16),t._uU(3,"Character Name"),t.qZA(),t.TgZ(4,"span"),t._uU(5),t.qZA()(),t.TgZ(6,"mat-list-item",15)(7,"span",16),t._uU(8,"Description"),t.qZA(),t._uU(9),t.qZA(),t.TgZ(10,"mat-list-item",15)(11,"span",16),t._uU(12,"Character Race"),t.qZA(),t._uU(13),t.qZA(),t.TgZ(14,"mat-list-item",15)(15,"span",16),t._uU(16,"Character Class"),t.qZA(),t._uU(17),t.qZA()()),2&i){const e=t.oxw(3);t.xp6(5),t.hij(" ",e.character.characterName," "),t.xp6(4),t.hij(" ",e.character.characterDescription," "),t.xp6(4),t.hij(" ",e.character.characterRace," "),t.xp6(4),t.hij(" ",e.character.characterClass," ")}}function ot(i,o){if(1&i&&t.YNc(0,nt,18,4,"mat-list",13),2&i){const e=t.oxw(2);t.Q6J("ngIf",e.character)}}function at(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div")(1,"mat-card")(2,"mat-card-header")(3,"img",1),t.NdJ("click",function(){t.CHM(e);const a=t.oxw();return t.KtG(a.openImageDialog())}),t.qZA(),t.TgZ(4,"mat-card-title"),t._uU(5),t.qZA(),t.TgZ(6,"mat-card-subtitle"),t._uU(7),t.qZA()(),t.YNc(8,z,2,1,"mat-card-actions",0),t.YNc(9,et,3,2,"mat-card-actions",0),t.qZA(),t.TgZ(10,"mat-tab-group",2)(11,"mat-tab",3),t.YNc(12,it,1,1,"ng-template",4),t.qZA(),t.TgZ(13,"mat-tab",5),t.YNc(14,ot,1,1,"ng-template",4),t.qZA()()()}if(2&i){const e=t.oxw();t.xp6(3),t.Akn((null==e.activeUser?null:e.activeUser.id)===e.user.id?"cursor: pointer":""),t.Q6J("src",e.user.img,t.LSH),t.xp6(2),t.Oqu(e.user.username),t.xp6(2),t.hij("@",e.user.username,""),t.xp6(1),t.Q6J("ngIf",(null==e.activeUser?null:e.activeUser.id)!==e.user.id),t.xp6(1),t.Q6J("ngIf",(null==e.activeUser?null:e.activeUser.id)===e.user.id)}}let st=(()=>{class i{get activeUser(){return this.authService.activeUser}constructor(e,n,a,s,m){this.activatedRoute=e,this.apiService=n,this.authService=a,this.dialog=s,this.toast=m,this.isLoadingLookingForGroup=!1}ngOnInit(){this.activatedRoute.params.pipe((0,R.z)(e=>this.apiService.getUserById(e.id))).subscribe({next:e=>{this.user=e,this.apiService.getCharactersheetByUserId(this.user.id).subscribe(n=>{n&&(this.character=n)})}})}openImageDialog(){this.activeUser&&this.activeUser.id===this.user.id&&this.dialog.open(N,{width:"30em",data:{id:this.user.id,collection:"users"}}).afterClosed().subscribe(n=>{n&&(this.user.img=n)})}toogleLookingForGroup(){!this.activeUser||this.activeUser.id!==this.user.id||(this.isLoadingLookingForGroup=!0,this.apiService.updateUser(this.user.id,{isLookingForGroup:!this.user.isLookingForGroup}).subscribe({next:e=>{this.user.isLookingForGroup=e.user.isLookingForGroup,this.isLoadingLookingForGroup=!1},error:e=>{this.isLoadingLookingForGroup=!1}}))}inviteToCampaign(){this.activeUser?.id!==this.user.id&&this.dialog.open(Q,{width:"30em",data:{userId:this.activeUser?.id,toInviteName:this.user.username}}).afterClosed().subscribe({next:n=>{n&&this.apiService.sendRequest({user:this.user.id,campaign:n,isSentByCreator:!0}).subscribe({next:s=>{s.id&&this.toast.success("Invitation to campaign sent!")},error:s=>{this.toast.error(s.error.errors[0].msg)}})}})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(d.gz),t.Y36(h),t.Y36(_.e),t.Y36(p.uw),t.Y36(v._W))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-profile"]],decls:1,vars:1,consts:[[4,"ngIf"],["mat-card-avatar","","alt","A user avatar",1,"profile-avatar",3,"src","click"],["mat-align-tabs","center"],["label","Comments"],["matTabContent",""],["label","Character Sheet"],["color","accent","mat-flat-button","",3,"click",4,"ngIf"],["color","accent","mat-flat-button","",3,"click"],["color","accent","mat-flat-button","",3,"disabled","click",4,"ngIf"],["color","warn","mat-flat-button","",3,"disabled","click",4,"ngIf"],["color","accent","mat-flat-button","",3,"disabled","click"],["color","warn","mat-flat-button","",3,"disabled","click"],[3,"userRef"],["class","example-list-wrapping",4,"ngIf"],[1,"example-list-wrapping"],["lines","2"],["matListItemTitle",""]],template:function(e,n){1&e&&t.YNc(0,at,15,7,"div",0),2&e&&t.Q6J("ngIf",n.user)},dependencies:[u.O5,g.lW,C.Vc,C.uX,C.SP,l.a8,l.hq,l.kc,l.dk,l.$j,l.n5,Z.i$,Z.Tg,Z.sL,J],styles:[".profile-avatar[_ngcontent-%COMP%]{width:5em;height:5em}"]}),i})();function rt(i,o){if(1&i&&(t.TgZ(0,"div")(1,"mat-card",1)(2,"mat-card-content",2)(3,"div")(4,"p",3),t._uU(5),t.qZA()(),t.TgZ(6,"div",4)(7,"p"),t._uU(8),t.qZA(),t.TgZ(9,"button",5)(10,"mat-icon"),t._uU(11,"play_circle"),t.qZA()()()()()()),2&i){const e=t.oxw();t.xp6(5),t.Oqu(e.post.title),t.xp6(3),t.AsE("",e.post.currentPlayers.length,"/",e.post.playersNeeded,""),t.xp6(1),t.MGl("routerLink","/dashboard/campaign-details/",e.post._id,"")}}function ct(i,o){if(1&i&&(t.TgZ(0,"div")(1,"mat-card",1)(2,"mat-card-content",2)(3,"div")(4,"p",3),t._uU(5),t.qZA()(),t.TgZ(6,"div",4)(7,"button",5)(8,"mat-icon"),t._uU(9,"play_circle"),t.qZA()()()()()()),2&i){const e=t.oxw();t.xp6(5),t.Oqu(e.user.username),t.xp6(2),t.MGl("routerLink","/dashboard/profile/",e.user.id,"")}}let mt=(()=>{class i{constructor(e){this.apiService=e}ngOnInit(){}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(h))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-post"]],inputs:{post:"post",user:"user"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"w-100","h-100"],[1,"d-flex","border","align-items-center","justify-content-between"],[1,"fw-bold"],[1,"d-flex","align-items-center"],["mat-icon-button","","color","accent","aria-label","Example icon button with a vertical three dot icon",3,"routerLink"]],template:function(e,n){1&e&&(t.YNc(0,rt,12,4,"div",0),t.YNc(1,ct,10,2,"div",0)),2&e&&(t.Q6J("ngIf",n.post),t.xp6(1),t.Q6J("ngIf",n.user))},dependencies:[u.O5,d.rH,g.RK,x.Hw,l.a8,l.dn],styles:["p[_ngcontent-%COMP%]{margin:0;padding:0}.post-container[_ngcontent-%COMP%]{height:4em}"]}),i})();function lt(i,o){if(1&i&&(t.TgZ(0,"mat-list-item"),t._UZ(1,"app-post",2),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Q6J("post",e)}}function pt(i,o){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,lt,2,1,"mat-list-item",1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.filteredPosts)}}function ut(i,o){if(1&i&&(t.TgZ(0,"mat-list-item"),t._UZ(1,"app-post",3),t.qZA()),2&i){const e=o.$implicit;t.xp6(1),t.Q6J("user",e)}}function dt(i,o){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,ut,2,1,"mat-list-item",1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.lookingForGroup)}}let Y=(()=>{class i{constructor(){this.filteredPosts=[],this.lookingForGroup=[]}}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-post-list"]],inputs:{filteredPosts:"filteredPosts",lookingForGroup:"lookingForGroup"},decls:3,vars:2,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"],[3,"post"],[3,"user"]],template:function(e,n){1&e&&(t.TgZ(0,"mat-list"),t.YNc(1,pt,2,1,"div",0),t.YNc(2,dt,2,1,"div",0),t.qZA()),2&e&&(t.xp6(1),t.Q6J("ngIf",n.filteredPosts),t.xp6(1),t.Q6J("ngIf",n.lookingForGroup))},dependencies:[u.sg,u.O5,Z.i$,Z.Tg,mt],styles:[".mdc-list-item[_ngcontent-%COMP%]{display:contents;margin-left:1em;margin-right:1em}mat-list-item[_ngcontent-%COMP%]{margin-bottom:10px}"]}),i})(),gt=(()=>{class i{constructor(e){this.api=e,this.campaignPosts=[],this.lfgPosts=[]}ngOnInit(){this.getCampaigns()}getCampaigns(){this.api.getCampaigns().subscribe({next:e=>{this.campaignPosts=e}})}getLfgPosts(){this.api.getLookingForGroupUsers().subscribe({next:e=>{this.lfgPosts=e.users}})}onTabClick(e){"Campaigns"===e.tab.textLabel?this.getCampaigns():"Looking for group"===e.tab.textLabel&&this.getLfgPosts()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(h))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-feed"]],decls:7,vars:2,consts:[["mat-align-tabs","center",3,"selectedTabChange"],["label","Campaigns"],[1,"content"],[3,"filteredPosts"],["label","Looking for group"],[3,"lookingForGroup"]],template:function(e,n){1&e&&(t.TgZ(0,"mat-tab-group",0),t.NdJ("selectedTabChange",function(s){return n.onTabClick(s)}),t.TgZ(1,"mat-tab",1)(2,"div",2),t._UZ(3,"app-post-list",3),t.qZA()(),t.TgZ(4,"mat-tab",4)(5,"div",2),t._UZ(6,"app-post-list",5),t.qZA()()()),2&e&&(t.xp6(3),t.Q6J("filteredPosts",n.campaignPosts),t.xp6(3),t.Q6J("lookingForGroup",n.lfgPosts))},dependencies:[C.uX,C.SP,Y]}),i})();var S=c(9383),ht=c(3649);let ft=(()=>{class i{constructor(e,n){this.authService=e,this.router=n}openProfile(){this.router.navigateByUrl(`dashboard/profile/${this.authService.activeUser.id}`)}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(_.e),t.Y36(d.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-bottom-nav"]],decls:10,vars:0,consts:[["color","primary",1,"d-flex","justify-content-evenly","aling-items-center"],["mat-icon-button","","routerLink","/dashboard/feed","aria-label","Example icon button with a vertical three dot icon"],["mat-fab","","matTooltip","Primary","color","accent","aria-label","Example fab with a heart icon","routerLink","/dashboard/create-post"],["mat-icon-button","","aria-label","Example icon button with a vertical three dot icon",3,"click"]],template:function(e,n){1&e&&(t.TgZ(0,"mat-toolbar",0)(1,"button",1)(2,"mat-icon"),t._uU(3,"forum"),t.qZA()(),t.TgZ(4,"button",2)(5,"mat-icon"),t._uU(6,"add"),t.qZA()(),t.TgZ(7,"button",3),t.NdJ("click",function(){return n.openProfile()}),t.TgZ(8,"mat-icon"),t._uU(9,"account_circle"),t.qZA()()())},dependencies:[d.rH,S.Ye,ht.gM,g.RK,g.cs,x.Hw]}),i})();var T=c(2659),_t=c(5308);let Ct=(()=>{class i{get activeUser(){return this.authService.activeUser}constructor(e,n,a){this.authService=e,this.router=n,this.api=a,this.notifications=0}ngOnInit(){this.getRequests(),this.getInvites()}getRequests(){this.api.getRequests(this.activeUser.id).subscribe({next:e=>{this.notifications+=e.length}})}getInvites(){this.api.getInvites(this.activeUser.id).subscribe({next:e=>{this.notifications+=e.length}})}logout(){this.router.navigateByUrl("/auth/login"),this.authService.logout().subscribe()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(_.e),t.Y36(d.F0),t.Y36(h))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-top-nav"]],decls:23,vars:2,consts:[["color","primary",1,"d-flex","justify-content-between"],["src","../../../../assets/logo.svg","alt","",1,"brand"],["mat-icon-button","","routerLink","/dashboard/notifications","aria-label","Example icon-button with heart icon",1,"example-icon","favorite-icon"],["matBadgeColor","warn",3,"matBadge"],["mat-icon-button","","routerLink","/dashboard/my-posts","aria-label","Example icon-button with heart icon",1,"example-icon","favorite-icon"],["mat-icon-button","","aria-label","Example icon-button with heart icon","routerLink","/dashboard/character-sheet",1,"example-icon","favorite-icon"],["mat-icon-button","","aria-label","Example icon-button with share icon",1,"example-icon",3,"matMenuTriggerFor"],["menu","matMenu"],["mat-menu-item","",3,"click"]],template:function(e,n){if(1&e&&(t.TgZ(0,"mat-toolbar",0)(1,"span"),t._UZ(2,"img",1),t.qZA(),t.TgZ(3,"div")(4,"button",2)(5,"mat-icon",3),t._uU(6,"notifications"),t.qZA()(),t.TgZ(7,"button",4)(8,"mat-icon"),t._uU(9,"chat_bubble"),t.qZA()(),t.TgZ(10,"button",5)(11,"mat-icon"),t._uU(12,"description"),t.qZA()(),t.TgZ(13,"button",6)(14,"mat-icon"),t._uU(15,"more_vert"),t.qZA()(),t.TgZ(16,"mat-menu",null,7)(18,"button",8),t.NdJ("click",function(){return n.logout()}),t.TgZ(19,"mat-icon"),t._uU(20,"logout"),t.qZA(),t.TgZ(21,"span"),t._uU(22,"Logout"),t.qZA()()()()()),2&e){const a=t.MAs(17);t.xp6(5),t.Q6J("matBadge",n.notifications?n.notifications:void 0),t.xp6(8),t.Q6J("matMenuTriggerFor",a)}},dependencies:[d.rH,S.Ye,g.RK,x.Hw,T.VK,T.OP,T.p6,_t.k],styles:[".brand[_ngcontent-%COMP%]{width:4em;height:4em}"]}),i})();function Zt(i,o){1&i&&(t.TgZ(0,"div",6)(1,"span"),t._uU(2,"You currently have no requests"),t.qZA()())}function Ut(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",7)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),t._uU(4),t.qZA(),t.TgZ(5,"mat-card-subtitle",8),t._uU(6),t.qZA(),t.TgZ(7,"mat-card-subtitle"),t._uU(8),t.ALo(9,"uppercase"),t.qZA()(),t.TgZ(10,"mat-card-actions",9)(11,"button",10),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw(2);return t.KtG(m.acceptRequest(s,"requests"))}),t.TgZ(12,"mat-icon"),t._uU(13,"check"),t.qZA()(),t.TgZ(14,"button",11)(15,"mat-icon"),t._uU(16,"info"),t.qZA()(),t.TgZ(17,"button",12),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw(2);return t.KtG(m.rejectRequest(s,"requests"))}),t.TgZ(18,"mat-icon"),t._uU(19,"close"),t.qZA()()()()()}if(2&i){const e=o.$implicit;t.xp6(4),t.Oqu(e.campaign.title),t.xp6(1),t.MGl("routerLink","/dashboard/profile/",e.user.id,""),t.xp6(1),t.Oqu(e.user.username),t.xp6(2),t.hij("Status: ",t.lcZ(9,7,e.status),""),t.xp6(3),t.Q6J("disabled","pending"!==e.status),t.xp6(3),t.MGl("routerLink","/dashboard/campaign-details/",e.campaign._id,""),t.xp6(3),t.Q6J("disabled","pending"!==e.status)}}function Tt(i,o){if(1&i&&(t.YNc(0,Zt,3,0,"div",4),t.YNc(1,Ut,20,9,"div",5)),2&i){const e=t.oxw();t.Q6J("ngIf",0===e.requests.length),t.xp6(1),t.Q6J("ngForOf",e.requests)}}function qt(i,o){1&i&&(t.TgZ(0,"div",6)(1,"span"),t._uU(2,"You currently have no invites"),t.qZA()())}function At(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"div",7)(1,"mat-card")(2,"mat-card-header")(3,"mat-card-title"),t._uU(4),t.qZA(),t.TgZ(5,"mat-card-subtitle"),t._uU(6),t.ALo(7,"uppercase"),t.qZA()(),t.TgZ(8,"mat-card-actions",9)(9,"button",10),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw(2);return t.KtG(m.acceptRequest(s,"invites"))}),t.TgZ(10,"mat-icon"),t._uU(11,"check"),t.qZA()(),t.TgZ(12,"button",11)(13,"mat-icon"),t._uU(14,"info"),t.qZA()(),t.TgZ(15,"button",12),t.NdJ("click",function(){const s=t.CHM(e).$implicit,m=t.oxw(2);return t.KtG(m.rejectRequest(s,"invites"))}),t.TgZ(16,"mat-icon"),t._uU(17,"close"),t.qZA()()()()()}if(2&i){const e=o.$implicit;t.xp6(4),t.Oqu(e.campaign.title),t.xp6(2),t.hij("Status: ",t.lcZ(7,5,e.status),""),t.xp6(3),t.Q6J("disabled","pending"!==e.status),t.xp6(3),t.MGl("routerLink","/dashboard/campaign-details/",e.campaign._id,""),t.xp6(3),t.Q6J("disabled","pending"!==e.status)}}function yt(i,o){if(1&i&&(t.YNc(0,qt,3,0,"div",4),t.YNc(1,At,18,7,"div",5)),2&i){const e=t.oxw();t.Q6J("ngIf",0===e.invites.length),t.xp6(1),t.Q6J("ngForOf",e.invites)}}function Nt(i,o){1&i&&(t.TgZ(0,"div",4)(1,"span"),t._uU(2,"You currently have no posts"),t.qZA()())}function It(i,o){if(1&i&&(t.TgZ(0,"div"),t._UZ(1,"app-post-list",5),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("filteredPosts",e.campaignPosts)}}function kt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"button",9),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(3);return t.KtG(a.joinCampaign())}),t._uU(1),t.qZA()}if(2&i){const e=t.oxw(3);t.Q6J("disabled",e.hasRequested),t.xp6(1),t.hij(" ",e.hasRequested?"Request sent":e.campaign.currentPlayers.length>=e.campaign.playersNeeded?"Campaign is full":"Request to join"," ")}}function Jt(i,o){if(1&i){const e=t.EpF();t.TgZ(0,"mat-card")(1,"mat-card-header",2),t._UZ(2,"img",3),t.TgZ(3,"mat-card-title"),t._uU(4),t.qZA(),t.TgZ(5,"mat-card-subtitle",4),t._uU(6),t.qZA(),t.TgZ(7,"div",5)(8,"p",6),t._uU(9),t._UZ(10,"br"),t._uU(11," Players "),t.qZA()()(),t.TgZ(12,"img",7),t.NdJ("click",function(){t.CHM(e);const a=t.oxw(2);return t.KtG(a.updateImage())}),t.qZA(),t.TgZ(13,"mat-card-content")(14,"p"),t._uU(15),t.qZA()(),t.TgZ(16,"mat-card-actions"),t.YNc(17,kt,2,2,"button",8),t.qZA()()}if(2&i){const e=t.oxw(2);t.xp6(2),t.s9C("src",e.campaign.creator.img,t.LSH),t.MGl("routerLink","/dashboard/profile/",e.campaign.creator.id,""),t.xp6(2),t.Oqu(e.campaign.title),t.xp6(2),t.hij("Dungeon Master: ",e.campaign.creator.username,""),t.xp6(3),t.AsE(" ",e.campaign.currentPlayers.length,"/",e.campaign.playersNeeded," "),t.xp6(3),t.s9C("src",e.campaign.img,t.LSH),t.xp6(3),t.hij(" ",e.campaign.description," "),t.xp6(2),t.Q6J("ngIf",e.activeUser.id!==e.campaign.creator.id)}}function Yt(i,o){if(1&i&&(t.TgZ(0,"div"),t.YNc(1,Jt,18,9,"mat-card",0),t._UZ(2,"app-comments-section",1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.campaign),t.xp6(1),t.Q6J("postRef",e.campaign._id)}}function Rt(i,o){if(1&i&&(t.TgZ(0,"mat-option",9),t._uU(1),t.qZA()),2&i){const e=o.$implicit;t.Q6J("value",e),t.xp6(1),t.Oqu(e)}}const wt=[{path:"",component:(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-main"]],decls:4,vars:0,consts:[[1,"main-content"]],template:function(e,n){1&e&&(t._UZ(0,"app-top-nav"),t.TgZ(1,"div",0),t._UZ(2,"router-outlet"),t.qZA(),t._UZ(3,"app-bottom-nav"))},dependencies:[d.lC,ft,Ct],styles:["app-top-nav[_ngcontent-%COMP%]{position:fixed;top:0;left:0;right:0;background-color:#f1f1f1;z-index:3}app-bottom-nav[_ngcontent-%COMP%]{position:fixed;bottom:0;left:0;right:0;background-color:#f1f1f1;z-index:3}.main-content[_ngcontent-%COMP%]{padding-top:56px;padding-bottom:3px;max-height:calc(100vh - 56px);overflow-y:auto}"]}),i})(),children:[{path:"profile/:id",component:st},{path:"feed",component:gt},{path:"create-post",component:(()=>{class i{get activeUser(){return this.auth.activeUser}constructor(e){this.auth=e}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(_.e))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-create-post"]],decls:11,vars:1,consts:[[1,"d-flex","gap-5","flex-column","justify-content-center","align-items-center","h100"],["mat-fab","","extended","","color","accent","routerLink","/dashboard/create-campaign"],["mat-fab","","extended","","color","accent",3,"routerLink"]],template:function(e,n){1&e&&(t.TgZ(0,"div",0)(1,"button",1)(2,"mat-icon"),t._uU(3,"add"),t.qZA(),t._uU(4," Create Campaign "),t.qZA(),t.TgZ(5,"p"),t._uU(6,"OR"),t.qZA(),t.TgZ(7,"button",2)(8,"mat-icon"),t._uU(9,"add"),t.qZA(),t._uU(10," Look for a Group "),t.qZA()()),2&e&&(t.xp6(7),t.MGl("routerLink","/dashboard/profile/",n.activeUser.id,""))},dependencies:[d.rH,g.cs,x.Hw],styles:[".h100[_ngcontent-%COMP%]{height:87vh}p[_ngcontent-%COMP%]{margin:0;padding:0;font-weight:bolder;font-size:large}"]}),i})()},{path:"create-campaign",component:(()=>{class i{get user(){return this.auth.activeUser}constructor(e,n,a,s,m){this.fb=e,this.api=n,this.auth=a,this.toastr=s,this.router=m,this.campaignForm=this.fb.group({title:["",[r.kI.required]],description:["",[r.kI.required]],playersNeeded:["",[r.kI.required]]})}createPost(){const{title:e,description:n,playersNeeded:a}=this.campaignForm.value;return this.api.createCampaign({title:e,description:n,playersNeeded:a,creator:this.user.id}).subscribe({next:m=>{m&&(this.toastr.success("Campaign created successfully!"),this.campaignForm.reset(),this.router.navigate(["/dashboard/campaign-details",m]))},error:m=>{console.error(m),this.toastr.error(m.error.errors[0].msg)}}),this.campaignForm.value}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(r.qu),t.Y36(h),t.Y36(_.e),t.Y36(v._W),t.Y36(d.F0))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-create-campaign"]],decls:16,vars:2,consts:[[1,"d-flex","gap-3","flex-column","justify-content-center","align-items-center","p-3",3,"formGroup","ngSubmit"],[1,"example-full-width"],["matInput","","placeholder","Ex. Curse of Strahd","formControlName","title"],["matInput","","type","number","placeholder","Ex. 4","formControlName","playersNeeded"],["matInput","","placeholder","Ex. You are trapped in the lands of Barovia...","formControlName","description"],["mat-raised-button","","color","accent","type","submit",3,"disabled"]],template:function(e,n){1&e&&(t.TgZ(0,"div")(1,"form",0),t.NdJ("ngSubmit",function(){return n.createPost()}),t.TgZ(2,"mat-form-field",1)(3,"mat-label"),t._uU(4,"Campaign Name"),t.qZA(),t._UZ(5,"input",2),t.qZA(),t.TgZ(6,"mat-form-field",1)(7,"mat-label"),t._uU(8,"Number of Players"),t.qZA(),t._UZ(9,"input",3),t.qZA(),t.TgZ(10,"mat-form-field",1)(11,"mat-label"),t._uU(12,"Description"),t.qZA(),t._UZ(13,"textarea",4),t.qZA(),t.TgZ(14,"button",5),t._uU(15," Post "),t.qZA()()()),2&e&&(t.xp6(1),t.Q6J("formGroup",n.campaignForm),t.xp6(13),t.Q6J("disabled",n.campaignForm.invalid))},dependencies:[g.lW,b.KE,b.hX,U.Nt,r._Y,r.Fj,r.wV,r.JJ,r.JL,r.sg,r.u],styles:["mat-form-field[_ngcontent-%COMP%]{width:87%}"]}),i})()},{path:"notifications",component:(()=>{class i{get activeUser(){return this.authService.activeUser}constructor(e,n,a){this.api=e,this.authService=n,this.toast=a,this.requests=[],this.invites=[]}ngOnInit(){this.getRequests(),this.getInvites()}getRequests(){this.api.getRequests(this.activeUser.id).subscribe({next:e=>{this.requests=e}})}getInvites(){this.api.getInvites(this.activeUser.id).subscribe({next:e=>{this.invites=e}})}acceptRequest(e,n){this.api.getCampaign(e.campaign._id).subscribe({next:a=>{a.currentPlayers.includes(e.user.id)?this.toast.error("User is already in campaign!"):a.currentPlayers.length>=a.playersNeeded?this.toast.error("Campaign is full!"):(a.currentPlayers.push(e.user.id),this.api.updateCampaign(a._id,a).subscribe({next:s=>{this.api.updateRequest(e._id,{status:"accepted"}).subscribe({next:m=>{"requests"===n?this.requests.find(q=>q._id===e._id).status="accepted":this.invites.find(q=>q._id===e._id).status="accepted",this.toast.success("Request accepted!")},error:m=>{this.toast.error(m.error.errors[0].msg)}})}}))}})}rejectRequest(e,n){this.api.updateRequest(e._id,{status:"rejected"}).subscribe({next:a=>{"requests"===n?(this.requests.find(s=>s._id===e._id).status="rejected",this.toast.success("Request rejected!")):(this.invites.find(s=>s._id===e._id).status="rejected",this.toast.success("Invite rejected!"))},error:a=>{this.toast.error(a.error.errors[0].msg)}})}deleteRequest(e){}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(h),t.Y36(_.e),t.Y36(v._W))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-notifications"]],decls:5,vars:0,consts:[["mat-align-tabs","center"],["label","Requests"],["matTabContent",""],["label","Invites"],["class","text-center mt-5",4,"ngIf"],["class","d-flex flex-column p-3",4,"ngFor","ngForOf"],[1,"text-center","mt-5"],[1,"d-flex","flex-column","p-3"],[3,"routerLink"],[1,"d-flex","justify-content-between"],["color","primary","mat-mini-fab","","aria-label","Accept icon button with a check icon",3,"disabled","click"],["color","accent","mat-mini-fab","","aria-label","Accept icon button with a check icon",3,"routerLink"],["color","warn","mat-mini-fab","","aria-label","Reject icon button with a check icon",3,"disabled","click"]],template:function(e,n){1&e&&(t.TgZ(0,"mat-tab-group",0)(1,"mat-tab",1),t.YNc(2,Tt,2,2,"ng-template",2),t.qZA(),t.TgZ(3,"mat-tab",3),t.YNc(4,yt,2,2,"ng-template",2),t.qZA()())},dependencies:[u.sg,u.O5,d.rH,g.nh,x.Hw,C.Vc,C.uX,C.SP,l.a8,l.hq,l.dk,l.$j,l.n5,u.gd]}),i})()},{path:"my-posts",component:(()=>{class i{get activeUser(){return this.auth.activeUser}constructor(e,n){this.api=e,this.auth=n,this.campaignPosts=[]}ngOnInit(){this.api.getCurrentUserCampaigns(this.activeUser.id).subscribe({next:e=>{this.campaignPosts=e}})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(h),t.Y36(_.e))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-my-posts"]],decls:4,vars:2,consts:[["mat-align-tabs","center"],["label","My Posts"],["class","text-center mt-5",4,"ngIf"],[4,"ngIf"],[1,"text-center","mt-5"],[3,"filteredPosts"]],template:function(e,n){1&e&&(t.TgZ(0,"mat-tab-group",0)(1,"mat-tab",1),t.YNc(2,Nt,3,0,"div",2),t.YNc(3,It,2,1,"div",3),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("ngIf",0===n.campaignPosts.length),t.xp6(1),t.Q6J("ngIf",n.campaignPosts.length>0))},dependencies:[u.O5,C.uX,C.SP,Y]}),i})()},{path:"campaign-details/:id",component:(()=>{class i{get activeUser(){return this.auth.activeUser}constructor(e,n,a,s,m){this.api=e,this.route=n,this.auth=a,this.dialog=s,this.toastr=m,this.hasRequested=!1,this.isLoading=[]}ngOnInit(){this.route.params.subscribe(e=>{this.api.getCampaign(e.id).subscribe({next:n=>{this.campaign=n,this.isLoading.push(!1),this.api.getRequests(this.activeUser.id).subscribe({next:a=>{a.find(m=>m.campaign._id===this.campaign._id&&(this.hasRequested=!0,!0))&&(this.hasRequested=!0,this.isLoading.push(!1)),this.isLoading.push(!1)}})}})})}updateImage(){this.activeUser.id===this.campaign.creator.id&&this.dialog.open(N,{width:"30em",data:{id:this.campaign._id,collection:"campaigns"}}).afterClosed().subscribe(n=>{n&&(this.campaign.img=n)})}joinCampaign(){this.activeUser.id!==this.campaign.creator.id&&this.campaign&&this.dialog.open(k,{width:"30em",data:{title:"Request to join campaign",message:`Do you want to join ${this.campaign.title}?`}}).afterClosed().subscribe(n=>{n&&this.api.sendRequest({user:this.activeUser.id,campaign:this.campaign._id,isSentByCreator:!1}).subscribe(s=>{this.hasRequested=!0,this.toastr.success("Request sent successfully")})})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(h),t.Y36(d.gz),t.Y36(_.e),t.Y36(p.uw),t.Y36(v._W))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-campaign-details"]],inputs:{campaign:"campaign"},decls:1,vars:1,consts:[[4,"ngIf"],[3,"postRef"],[1,"d-flex"],["alt","Dungeon master profile pic","mat-card-avatar","",3,"src","routerLink"],[1,"me-5"],[1,"d-flex","align-items-center","justify-items-end"],[1,"p-0","m-0","text-center","fw-bolder"],["mat-card-image","","alt","Photo of the campaign",3,"src","click"],["mat-raised-button","","color","accent",3,"disabled","click",4,"ngIf"],["mat-raised-button","","color","accent",3,"disabled","click"]],template:function(e,n){1&e&&t.YNc(0,Yt,3,2,"div",0),2&e&&t.Q6J("ngIf",n.campaign&&n.isLoading.length>=2)},dependencies:[u.O5,d.rH,g.lW,l.a8,l.hq,l.kc,l.dn,l.dk,l.G2,l.$j,l.n5,J],styles:["img[_ngcontent-%COMP%]{max-height:30em}"]}),i})()},{path:"character-sheet",component:(()=>{class i{get activeUser(){return this.auth.activeUser}constructor(e,n,a,s){this.fb=e,this.api=n,this.auth=a,this.toastr=s,this.magia="magia",this.editMode=!1,this.classOptions=["Barbarian","Bard","Cleric","Druid","Fighter","Monk","Paladin","Ranger","Rogue","Sorcerer","Warlock","Wizard","Blood Hunter","Artificer"],this.characterForm=this.fb.group({characterName:["",[r.kI.required]],characterRace:["",[r.kI.required]],characterDescription:["",[r.kI.required]],characterClass:["",[r.kI.required]]})}ngOnInit(){this.api.getCharactersheetByUserId(this.activeUser.id).subscribe(e=>{if(e){const{_id:n,creator:a,...s}=e;this.magia=n,this.characterForm.setValue(s),this.characterForm.disable()}})}updateCharacter(){this.api.updateCharactersheet(this.magia,this.characterForm.value).subscribe(e=>{this.toastr.success("Character sheet updated!"),this.characterForm.disable(),this.editMode=!1})}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(r.qu),t.Y36(h),t.Y36(_.e),t.Y36(v._W))},i.\u0275cmp=t.Xpm({type:i,selectors:[["app-character-sheet"]],decls:23,vars:7,consts:[[1,"d-flex","gap-3","flex-column","justify-content-center","align-items-center","p-3",3,"formGroup","ngSubmit"],["matInput","","formControlName","characterName","placeholder","Ex. Dorian Storm",3,"disabled"],["matInput","","formControlName","characterRace","placeholder","Ex. Air Genasi",3,"disabled"],["matInput","","formControlName","characterDescription","placeholder","Ex. A noble bard who escaped his family, and is in pursuit of a greater purpose",3,"disabled"],["formControlName","characterClass",3,"disabled"],[3,"value",4,"ngFor","ngForOf"],[1,"d-flex","align-items-center","gap-3"],["mat-raised-button","","color","accent","type","submit",3,"disabled"],["mat-raised-button","","color","primary","type","button",3,"click"],[3,"value"]],template:function(e,n){1&e&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return n.updateCharacter()}),t.TgZ(1,"mat-form-field")(2,"mat-label"),t._uU(3,"Character Name"),t.qZA(),t._UZ(4,"input",1),t.qZA(),t.TgZ(5,"mat-form-field")(6,"mat-label"),t._uU(7,"Character Race"),t.qZA(),t._UZ(8,"input",2),t.qZA(),t.TgZ(9,"mat-form-field")(10,"mat-label"),t._uU(11,"Character Description"),t.qZA(),t._UZ(12,"textarea",3),t.qZA(),t.TgZ(13,"mat-form-field")(14,"mat-label"),t._uU(15,"Character Class"),t.qZA(),t.TgZ(16,"mat-select",4),t.YNc(17,Rt,2,2,"mat-option",5),t.qZA()(),t.TgZ(18,"div",6)(19,"button",7),t._uU(20," Save "),t.qZA(),t.TgZ(21,"button",8),t.NdJ("click",function(){return n.editMode=!n.editMode,n.characterForm.enabled?n.characterForm.disable():n.characterForm.enable()}),t._uU(22," Edit "),t.qZA()()()),2&e&&(t.Q6J("formGroup",n.characterForm),t.xp6(4),t.Q6J("disabled",!n.editMode),t.xp6(4),t.Q6J("disabled",!n.editMode),t.xp6(4),t.Q6J("disabled",!n.editMode),t.xp6(4),t.Q6J("disabled",!n.editMode),t.xp6(1),t.Q6J("ngForOf",n.classOptions),t.xp6(2),t.Q6J("disabled",!n.editMode))},dependencies:[u.sg,g.lW,b.KE,b.hX,U.Nt,I.gD,P.ey,r._Y,r.Fj,r.JJ,r.JL,r.sg,r.u],styles:["mat-form-field[_ngcontent-%COMP%]{width:87%}"]}),i})()},{path:"**",redirectTo:"feed"}]}];let Lt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[d.Bz.forChild(wt),d.Bz]}),i})();var Ot=c(8019);let Mt=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[u.ez,Lt,Ot.q,r.UX]}),i})()}}]);